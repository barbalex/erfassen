(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{321:function(e,t,n){"use strict";n(41),n(93);var r=n(11),a=n.n(r),o=n(0),s=n.n(o),i=n(92),c=n(340),l=n.n(c),u=i.b.div.withConfig({displayName:"ErrorBoundary__Container",componentId:"sc-1fvc7se-0"})(["margin:10px;"]),p=i.b.div.withConfig({displayName:"ErrorBoundary__ErrorTitle",componentId:"sc-1fvc7se-1"})(["margin-bottom:10px;"]),d=Object(i.b)(l.a).withConfig({displayName:"ErrorBoundary__ReloadButton",componentId:"sc-1fvc7se-2"})(["margin-top:10px !important;"]),m=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={error:null,errorInfo:null},n}a()(t,e);var n=t.prototype;return n.componentDidCatch=function(e,t){this.setState({error:e,errorInfo:t})},n.render=function(){var e=this,t=this.state.errorInfo;if(t)return console.log("errorInfo:",t),s.a.createElement(u,null,s.a.createElement(p,null,"Oh je, es ist ein Fehler aufgetreten! Bericht:"),s.a.createElement("div",null,t.componentStack),s.a.createElement(d,{variant:"outlined",onClick:function(){"undefined"!=typeof window&&window.location.reload(!1)}},"Neu laden"));var n=this.props.children;return s.a.Children.map(n,function(t){return s.a.cloneElement(t,Object.assign({},e.props))})},t}(o.Component);t.a=m},346:function(e,t,n){"use strict";var r=n(455),a=n(0),o=n.n(a),s=n(456),i=n.n(s),c=n(63),l=(n(376),n(377),n(612)),u=n.n(l),p=n(614),d=n.n(p),m=n(335),f=n.n(m),h=n(340),g=n.n(h),w=n(92),b=n(22),E=n(328),v=n.n(E),y=n(333),x=n.n(y),S=(n(378),n(391)),k=n.n(S),C=n(609),P=n.n(C),O=n(600),_=n.n(O),I=n(599),T=n(379),j=n.n(T),D=n(323),q=n.n(D),A=(n(339),n(324)),N=n.n(A),B=n(415),L=n.n(B),H=n(426),z=n.n(H),F=n(432),K=n.n(F),M=n(422),U=n.n(M),W=n(428),V=n.n(W),J=n(430),R=n.n(J),Q=n(427),G=n.n(Q),X=n(429),Y=n.n(X),Z=n(431),$=n(321),ee=n(375),te=Object(w.b)(L.a).withConfig({displayName:"Signup__StyledDialog",componentId:"sc-1xn6wqs-0"})([""]),ne=w.b.div.withConfig({displayName:"Signup__StyledDiv",componentId:"sc-1xn6wqs-1"})(["display:flex;flex-direction:column;padding:0 24px;"]),re=Object(w.b)(U.a).withConfig({displayName:"Signup__StyledInput",componentId:"sc-1xn6wqs-2"})(["&:before{border-bottom-color:rgba(0,0,0,0.1) !important;}"]),ae=v()(ee.a,j()("email","setEmail",""),j()("password","setPassword",""),j()("showPass","setShowPass",!1),j()("emailErrorText","setEmailErrorText",""),j()("passwordErrorText","setPasswordErrorText",""),x()({close:function(e){var t=e.authState;return function(){return t.setSignupOpen(!1)}},onClickSignup:function(e){var t=e.email,n=e.password,r=e.authState;return N()(q.a.mark(function e(){return q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.signUp({email:t,password:n});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log("Signup: error logging in:",e.t0);case 8:case"end":return e.stop()}},e,this,[[0,5]])}))},onToggleShowPass:function(e){var t=e.showPass,n=e.setShowPass;return function(){n(!t)}}}),x()({onBlurEmail:function(e){var t=e.setEmail;return function(e){return t(e.target.value)}},onBlurPassword:function(e){var t=e.setPassword;return function(e){return t(e.target.value)}}}))(function(e){var t=e.email,n=e.password,r=e.showPass,a=(e.setShowPass,e.emailErrorText),s=e.passwordErrorText,i=(e.setEmailErrorText,e.setPasswordErrorText,e.onBlurEmail),c=e.onBlurPassword,l=e.onClickSignup,u=(e.user,e.close),p=e.onToggleShowPass,d=(e.db,e.authState);return o.a.createElement($.a,null,o.a.createElement(te,{"aria-labelledby":"dialog-title",open:d.state.signupOpen},o.a.createElement(z.a,{id:"dialog-title"},"Neues Konto"),o.a.createElement(ne,null,o.a.createElement(G.a,{error:!!a,fullWidth:!0,"aria-describedby":"emailHelper"},o.a.createElement(V.a,{htmlFor:"email"},"Email"),o.a.createElement(re,{id:"email",defaultValue:t,onBlur:i,autoFocus:!0,onKeyPress:function(e){"Enter"===e.key&&i()}}),o.a.createElement(Y.a,{id:"emailHelper"},a)),o.a.createElement(G.a,{error:!!s,fullWidth:!0,"aria-describedby":"passwortHelper"},o.a.createElement(V.a,{htmlFor:"passwort"},"Passwort"),o.a.createElement(re,{id:"passwort",type:r?"text":"password",defaultValue:n,onBlur:c,onKeyPress:function(e){"Enter"===e.key&&c()},autoComplete:"current-password",autoCorrect:"off",spellCheck:"false",endAdornment:o.a.createElement(R.a,{position:"end"},o.a.createElement(k.a,{onClick:p,onMouseDown:function(e){return e.preventDefault()},title:r?"verstecken":"anzeigen"},r?o.a.createElement(Z.b,null):o.a.createElement(Z.a,null)))}),o.a.createElement(Y.a,{id:"passwortHelper"},s))),o.a.createElement(K.a,null,o.a.createElement(g.a,{onClick:u},"abbrechen"),o.a.createElement(g.a,{color:"primary",onClick:l},"Konto erstellen"))))}),oe=n(433),se=w.b.div.withConfig({displayName:"Account__IconContainer",componentId:"huyud8-0"})(["position:relative;padding-left:10px;"]),ie=w.b.div.withConfig({displayName:"Account__UserNameDiv",componentId:"huyud8-1"})(["position:absolute;bottom:0;font-size:10px;width:60px;left:5px;text-align:center;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;z-index:-1;"]),ce=v()(ee.a,j()("anchorEl","setAnchorEl",null),x()({onClickMenu:function(e){var t=e.setAnchorEl;return function(e){return t(e.currentTarget)}},onCloseMenu:function(e){var t=e.setAnchorEl;return function(){return t(null)}},onClickSignup:function(e){var t=e.setAnchorEl,n=e.authState;return function(){t(null),n.setSignupOpen(!n.state.signupOpen)}},onClickLogin:function(e){var t=e.setAnchorEl,n=e.authState;return function(){t(null),n.setLoginOpen(!n.state.loginOpen)}},onClickLogout:function(e){var t=e.setAnchorEl,n=e.authState;return function(){t(null),n.logOut()}}}))(function(e){var t=e.anchorEl,n=e.onCloseMenu,r=e.onClickMenu,a=e.onClickSignup,s=e.onClickLogout,i=e.onClickLogin,c=e.authState.state,l=c.name,u=c.signupOpen,p=c.loginOpen;return o.a.createElement($.a,null,o.a.createElement(o.a.Fragment,null,o.a.createElement(se,null,o.a.createElement(k.a,{"aria-haspopup":"true","aria-label":"Konto",onClick:r,color:"inherit",title:"Konto"},o.a.createElement(I.a,null)),o.a.createElement(ie,null,l||"")),o.a.createElement(_.a,{id:"menu-appbar",anchorEl:t,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:!!t,onClose:n},!l&&o.a.createElement(P.a,{onClick:i},"Anmelden"),l&&o.a.createElement(P.a,{onClick:s},"Abmelden"),o.a.createElement(P.a,{onClick:a},"Konto erstellen")),u&&o.a.createElement(ae,null),p&&o.a.createElement(oe.a,null)))}),le=Object(w.b)(f.a).withConfig({displayName:"Header__SiteTitle",componentId:"sc-1q5cq7d-0"})(["display:none;cursor:pointer;@media (min-width:700px){display:block;}"]),ue=w.b.div.withConfig({displayName:"Header__Spacer",componentId:"sc-1q5cq7d-1"})(["flex-grow:1;"]),pe=Object(w.b)(g.a).withConfig({displayName:"Header__NavButton",componentId:"sc-1q5cq7d-2"})(["color:white !important;border:",";border-color:rgba(255,255,255,0.5) !important;font-weight:",";"],function(e){return e.active?"1px white":"unset"},function(e){return e.active?"700":"600"}),de=v()(x()({onClickSiteTitle:function(){return function(){return Object(c.navigate)("/")}}}))(function(e){var t=e.onClickSiteTitle;return o.a.createElement(b.Location,null,function(e){var n=e.location.pathname;return o.a.createElement($.a,null,o.a.createElement(u.a,{position:"fixed"},o.a.createElement(d.a,null,o.a.createElement(le,{variant:"h6",color:"inherit",noWrap:!0,title:"Home",onClick:t},"erfassen.ch"),o.a.createElement(ue,null),o.a.createElement(pe,{variant:"/"===n?"outlined":"text",component:c.Link,to:"/",active:("/"===n).toString()},"Home"),o.a.createElement(pe,{variant:"/Projekte/"===n?"outlined":"text",component:c.Link,to:"/Projekte/",active:("/Projekte/"===n).toString()},"Projekte"),o.a.createElement(ce,null))))})});t.a=function(e){var t=e.children;return o.a.createElement(c.StaticQuery,{query:"4130953669",render:function(e){return o.a.createElement(o.a.Fragment,null,o.a.createElement(i.a,{title:e.site.siteMetadata.title,meta:[{name:"description",content:"Sample"},{name:"keywords",content:"sample, something"}]},o.a.createElement("html",{lang:"en"})),o.a.createElement(de,null),t)},data:r})}},375:function(e,t,n){"use strict";n(41);var r=n(0),a=n.n(r),o=n(107),s=(n(105),n(479),n(179),n(180),n(378),n(323)),i=n.n(s),c=(n(339),n(324)),l=n.n(c),u=n(11),p=n.n(u),d=n(40),m=n.n(d),f=(n(182),n(83)),h=n(682),g=n(343),w=n.n(g),b=(n(170),n(452)),E=n(555),v=n(453),y=n(556),x=n(557),S=n(558),k=n(559);b.a.plugin(E.a),b.a.plugin(v.a);var C=l()(i.a.mark(function e(){var t,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={},n={},e.prev=2,e.next=5,b.a.create({name:"erfassen",adapter:"idb"});case 5:n.erfassen=e.sent,e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(2),e.t0;case 11:return e.next=13,n.erfassen.collection({name:"message",schema:k});case 13:return e.next=15,n.erfassen.collection({name:"zeit",schema:y});case 15:return e.next=17,n.erfassen.collection({name:"ort",schema:x});case 17:return e.next=19,n.erfassen.ort.sync({remote:"http://localhost:5984/erfassen/",options:{live:!0,retry:!0},query:n.erfassen.ort.find().where("type").eq("ort")});case 19:return t.ort=e.sent,e.next=22,n.erfassen.collection({name:"beob",schema:S});case 22:return t.beob=n.erfassen.beob.sync({remote:"http://localhost:5984/erfassen/",options:{live:!0,retry:!0},query:n.erfassen.beob.find().where("type").eq("beob")}),e.abrupt("return",{dbs:n,syncs:t});case 24:case"end":return e.stop()}},e,this,[[2,8]])})),P=(n(43),function(){if("undefined"==typeof window)return"https://erfassen.ch:5984/erfassen";var e="localhost"===window.location.hostname.replace("www.",""),t=e?"localhost":window.location.hostname;return e?"http://"+t+":5984/erfassen":"https://erfassen.ch:5984/erfassen"}),O=(n(560),n(561),n(564)),_=n.n(O),I=n(565);b.a.plugin(v.a);var T=function(){var e=l()(i.a.mark(function e(t){var n,r,a,o,s,c,l,u,p;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.authState,r=t.email,console.log("createAndSyncUserCollections",{authState:n}),a=n.state,o=a.dbs,s=a.syncs,c=_()(r),console.log("createAndSyncUserCollections",{dbs:o,syncs:s}),e.prev=5,e.next=8,b.a.create({name:c,adapter:"idb",pouchSettings:{fetch:function(e,t){return t.credentials="include",PouchDB.fetch(e,t)}}});case 8:return l=e.sent,e.next=11,l.collection({name:"user",schema:I,pouchSettings:{fetch:function(e,t){return t.credentials="include",PouchDB.fetch(e,t)}}});case 11:e.next=21;break;case 13:if(e.prev=13,e.t0=e.catch(5),!e.t0.message.includes("already exists")){e.next=20;break}return console.log("user db already exists"),e.abrupt("return");case 20:throw e.t0;case 21:n.addDb({name:c,db:l}),u=!!s&&!!s[c],console.log("createAndSyncUserCollections",{dbs:o}),u||(p=l.user.sync({remote:"http://localhost:5984/"+c+"/",options:{live:!0,retry:!0},query:l.user.find().where("type").eq("user")})),n.addSync({name:c,sync:p}),console.log("Signup",{dbs:o,userDbName:c});case 27:case"end":return e.stop()}},e,this,[[5,13]])}));return function(t){return e.apply(this,arguments)}}();f.a.plugin(h.a);var j=function(e){function t(t){var n;(n=e.call(this)||this).setAuthDb=function(e){n.setState(function(t){return{authDb:e}})},n.setName=function(e){n.setState(function(t){return{name:e}})},n.setSignupOpen=function(e){n.setState(function(t){return{signupOpen:e}})},n.setLoginOpen=function(e){n.setState(function(t){return{loginOpen:e}})},n.signUp=function(){var e=l()(i.a.mark(function e(t){var r,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.email,a=t.password,e.prev=1,e.next=4,n.logOut();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.log("Auth, signUp: Error logging out:",e.t0);case 9:return e.prev=9,e.next=12,n.state.authDb.signUp(r,a);case 12:e.next=17;break;case 14:e.prev=14,e.t1=e.catch(9),console.log("Signup: error logging in:",e.t1);case 17:return n.setSignupOpen(!1),e.prev=18,e.next=21,n.logIn({email:r,password:a});case 21:e.next=26;break;case 23:throw e.prev=23,e.t2=e.catch(18),e.t2;case 26:case"end":return e.stop()}},e,this,[[1,6],[9,14],[18,23]])}));return function(t){return e.apply(this,arguments)}}(),n.logIn=function(){var e=l()(i.a.mark(function e(t){var r,a,o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.email,a=t.password,e.prev=1,e.next=4,n.logOut();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.log("Auth, logIn: Error logging out:",e.t0);case 9:return e.prev=9,e.next=12,n.state.authDb.logIn(r,a);case 12:o=e.sent,e.next=22;break;case 15:if(e.prev=15,e.t1=e.catch(9),"unauthorized"!==e.t1.name&&"forbidden"!==e.t1.name){e.next=21;break}throw new Error("Name oder Passwort stimmt nicht");case 21:throw e.t1;case 22:console.log("Auth, logIn: logInResponce logging in:",o),n.setState(function(e){return{name:o.name,loginOpen:!1,authDb:new f.a(P())}}),T({email:r,authState:m()(m()(n))});case 25:case"end":return e.stop()}},e,this,[[1,6],[9,15]])}));return function(t){return e.apply(this,arguments)}}(),n.logOut=l()(i.a.mark(function e(){var t,r,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.state.authDb.logOut();case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:return t=n.state,r=t.dbs,a=t.syncs,Object.values(r).forEach(function(e){return e.remove()}),Object.values(a).forEach(function(e){return e.cancel()}),n.setState(function(e){return{name:null,loginOpen:!1,dbs:null,syncs:{}}}),e.abrupt("return");case 13:case"end":return e.stop()}},e,this,[[0,5]])})),n.addDb=function(e){var t=e.name,r=e.db;console.log("Auth, addDb",{name:t,db:r,dbs:n.state.dbs}),n.setState(function(e){var n,a=Object.assign({},e.dbs,((n={})[t]=r,n));return console.log("Auth, addDb",{newDbs:a}),window.dbs=a,{dbs:a}})},n.addSync=function(e){var t=e.name,r=e.sync;n.setState(function(e){var n,a=Object.assign({},e.syncs,((n={})[t]=r,n));return{dbs:e.dbs,syncs:a}})};var r=new f.a(P()),a="undefined"==typeof window?null:window.dbs||null;return n.state={authDb:r,name:null,signupOpen:!1,loginOpen:!1,dbs:a,syncs:{}},r.getSession().then(function(e){var t=w()(e,"userCtx.name",null);t&&n.setState(function(e){return{name:t}})}).catch(function(e){throw e}),("undefined"!=typeof window&&!window.dbs||"undefined"==typeof window)&&C().then(function(e){var t=e.dbs,r=e.syncs;n.setState(function(e){return{dbs:t,syncs:r}}),"undefined"!=typeof window&&(window.dbs=t)}).catch(function(e){throw e}),n}return p()(t,e),t}(o.a);t.a=function(e){return function(t){return a.a.createElement(o.c,{to:[j]},function(n){return a.a.createElement(e,Object.assign({authState:n},t))})}}},433:function(e,t,n){"use strict";var r=n(323),a=n.n(r),o=(n(339),n(324)),s=n.n(o),i=n(0),c=n.n(i),l=n(415),u=n.n(l),p=n(426),d=n.n(p),m=n(432),f=n.n(m),h=n(422),g=n.n(h),w=n(428),b=n.n(w),E=n(430),v=n.n(E),y=n(427),x=n.n(y),S=n(429),k=n.n(S),C=n(391),P=n.n(C),O=n(431),_=n(340),I=n.n(_),T=n(92),j=n(328),D=n.n(j),q=n(333),A=n.n(q),N=n(379),B=n.n(N),L=n(321),H=n(375),z=Object(T.b)(u.a).withConfig({displayName:"Login__StyledDialog",componentId:"mq7maw-0"})([""]),F=T.b.div.withConfig({displayName:"Login__StyledDiv",componentId:"mq7maw-1"})(["display:flex;flex-direction:column;padding:0 24px;"]),K=Object(T.b)(g.a).withConfig({displayName:"Login__StyledInput",componentId:"mq7maw-2"})(["&:before{border-bottom-color:rgba(0,0,0,0.1) !important;}"]),M=D()(H.a,B()("email","setEmail",""),B()("password","setPassword",""),B()("showPass","setShowPass",!1),B()("emailErrorText","setEmailErrorText",""),B()("passwordErrorText","setPasswordErrorText",""),A()({close:function(e){var t=e.authState;return function(){return t.setLoginOpen(!1)}},onClickLogin:function(e){var t=e.email,n=e.password,r=e.authState,o=e.setEmailErrorText,i=e.setPasswordErrorText;return s()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.logIn({email:t,password:n});case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),o(e.t0.message),i(e.t0.message);case 9:case"end":return e.stop()}},e,this,[[0,5]])}))},onToggleShowPass:function(e){var t=e.showPass,n=e.setShowPass;return function(){n(!t)}}}),A()({onBlurEmail:function(e){var t=e.setEmail;return function(e){return t(e.target.value)}},onBlurPassword:function(e){var t=e.setPassword;return function(e){return t(e.target.value)}}}));t.a=M(function(e){var t=e.email,n=e.password,r=e.showPass,a=(e.setShowPass,e.emailErrorText),o=e.passwordErrorText,s=(e.setEmailErrorText,e.setPasswordErrorText,e.onBlurEmail),i=e.onBlurPassword,l=e.onClickLogin,u=e.close,p=e.onToggleShowPass,m=e.authState;return c.a.createElement(L.a,null,c.a.createElement(z,{"aria-labelledby":"login-dialog-title",open:m.state.loginOpen},c.a.createElement(d.a,{id:"login-dialog-title"},"Anmeldung"),c.a.createElement(F,null,c.a.createElement(x.a,{error:!!a,fullWidth:!0,"aria-describedby":"loginEmailHelper"},c.a.createElement(b.a,{htmlFor:"loginEmail"},"Email"),c.a.createElement(K,{id:"loginEmail",defaultValue:t,onBlur:s,autoFocus:!0,onKeyPress:function(e){"Enter"===e.key&&s(e)}}),c.a.createElement(k.a,{id:"loginEmailHelper"},a)),c.a.createElement(x.a,{error:!!o,fullWidth:!0,"aria-describedby":"loginPasswortHelper"},c.a.createElement(b.a,{htmlFor:"loginPasswort"},"Passwort"),c.a.createElement(K,{id:"loginPasswort",type:r?"text":"password",defaultValue:n,onBlur:i,onKeyPress:function(e){"Enter"===e.key&&i(e)},autoComplete:"current-password",autoCorrect:"off",spellCheck:"false",endAdornment:c.a.createElement(v.a,{position:"end"},c.a.createElement(P.a,{onClick:p,onMouseDown:function(e){return e.preventDefault()},title:r?"verstecken":"anzeigen"},r?c.a.createElement(O.b,null):c.a.createElement(O.a,null)))}),c.a.createElement(k.a,{id:"loginPasswortHelper"},o))),c.a.createElement(f.a,null,c.a.createElement(I.a,{onClick:u},"abbrechen"),c.a.createElement(I.a,{color:"primary",onClick:l},"Anmelden"))))})},455:function(e){e.exports={data:{site:{siteMetadata:{title:"erfassen"}}}}},527:function(e,t){},544:function(e,t){},556:function(e){e.exports={title:"zeit schema",version:0,description:"describes a date",type:"object",properties:{type:{type:"string"},zeit:{type:"string",primary:!0}},required:["zeit","type"]}},557:function(e){e.exports={title:"ort schema",version:0,description:"describes a location",type:"object",properties:{type:{type:"string"},parentId:{type:"string"},name:{type:"string"}},required:["name","type"]}},558:function(e){e.exports={title:"beob schema",version:0,description:"describes a sighting",type:"object",properties:{type:{type:"string"},parentId:{type:"string"},art:{type:"string"}},required:["art","type"]}},559:function(e){e.exports={title:"message schema",version:0,description:"describes a message",type:"object",properties:{type:{type:"string"},message:{type:"string"}},required:["type"]}},564:function(e,t,n){n(43),e.exports=function(e){return"user_"+e.toLowerCase().replace("@","_at_").replace(".","_p_")}},565:function(e){e.exports={title:"user doc schema",version:0,description:"describes a user doc",type:"object",properties:{type:{type:"string"},name:{type:"string"},projects:{type:"array",items:{type:"string"}}},required:["name","type"]}}}]);
//# sourceMappingURL=2-1edca52027bf6d0e40d5.js.map