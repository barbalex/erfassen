{"version":3,"sources":["webpack:///./src/components/ErrorBoundary.tsx","webpack:///./src/utils/createAndSyncUserCollection.ts","webpack:///./src/components/Header/Signup.tsx","webpack:///./src/components/Header/Account.tsx","webpack:///./src/components/Header/index.tsx","webpack:///./src/components/Layout.tsx","webpack:///./src/utils/couchUrl.ts","webpack:///./src/state/Auth.ts","webpack:///./src/state/withAuth.js","webpack:///./src/components/Header/Login.tsx","webpack:///./src/utils/createRxDb.ts","webpack:///./src/state/RxDb.ts","webpack:///./src/state/withRxDb.js","webpack:///./src/utils/userDbNameFromUserName.ts"],"names":["Container","styled","div","withConfig","displayName","componentId","ErrorTitle","ReloadButton","Button","ErrorBoundary","props","_this","_Component","call","this","state","error","errorInfo","componentDidCatch","setState","render","_this2","console","log","react__WEBPACK_IMPORTED_MODULE_3___default","a","createElement","componentStack","variant","onClick","window","location","reload","children","React","Children","map","child","cloneElement","Object","assign","Component","rxdb","plugin","pouchdbAdapterIdb","createAndSyncUserCollection","_ref2","asyncToGenerator_default","regenerator_default","mark","_callee","_ref","rxDbState","email","_rxDbState$state","dbs","syncs","userDbName","userDb","isAlreadyBeingSynced","sync","wrap","_context","prev","next","userDbNameFromUserName","isRxDatabase","create","name","adapter","sent","collection","schema","userDocSchema","addDb","db","user","remote","options","live","retry","query","find","where","eq","addSync","stop","_x","apply","arguments","StyledDialog","Dialog","StyledDiv","StyledInput","Input","enhance","compose","withAuthState","withRxDbState","withState","withHandlers","close","authState","setSignupOpen","onClickSignup","password","authDb","signUp","t0","logIn","t1","onToggleShowPass","_ref4","showPass","setShowPass","onBlurEmail","_ref5","setEmail","event","target","value","onBlurPassword","_ref6","setPassword","_ref7","emailErrorText","passwordErrorText","setEmailErrorText","setPasswordErrorText","react_default","aria-labelledby","open","signupOpen","DialogTitle_default","id","FormControl_default","fullWidth","aria-describedby","InputLabel_default","htmlFor","defaultValue","onBlur","autoFocus","onKeyPress","e","key","FormHelperText_default","type","autoComplete","autoCorrect","spellCheck","endAdornment","InputAdornment_default","position","IconButton_default","onMouseDown","preventDefault","title","md","DialogActions_default","Button_default","color","IconContainer","UserNameDiv","onClickMenu","setAnchorEl","currentTarget","onCloseMenu","_ref3","onClickLogin","setLoginOpen","loginOpen","onClickLogout","logOut","anchorEl","_authState$state","Fragment","aria-haspopup","aria-label","fa","Menu_default","anchorOrigin","vertical","horizontal","transformOrigin","onClose","MenuItem_default","Header_Signup","Login","SiteTitle","Typography","Spacer","NavButton","active","onClickSiteTitle","navigate","es","pathname","AppBar_default","Toolbar_default","noWrap","component","Link","to","toString","Header_Account","Layout","gatsby_browser_entry","data","Helmet_default","site","siteMetadata","meta","content","lang","components_Header","_4130953669","couchUrl","isLocalhost","hostname","replace","PouchDB","pouchdbAuthentication","AuthContainer","_Container","setAuthDb","setName","logInResponce","Error","_callee2","_context2","getSession","then","resp","get","catch","__webpack_exports__","WrappedComponent","unstated_es","AuthState","_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2___default","_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default","_ErrorBoundary__WEBPACK_IMPORTED_MODULE_19__","_material_ui_core_DialogTitle__WEBPACK_IMPORTED_MODULE_5___default","_material_ui_core_FormControl__WEBPACK_IMPORTED_MODULE_10___default","_material_ui_core_InputLabel__WEBPACK_IMPORTED_MODULE_8___default","_material_ui_core_FormHelperText__WEBPACK_IMPORTED_MODULE_11___default","_material_ui_core_InputAdornment__WEBPACK_IMPORTED_MODULE_9___default","_material_ui_core_IconButton__WEBPACK_IMPORTED_MODULE_12___default","react_icons_md__WEBPACK_IMPORTED_MODULE_13__","_material_ui_core_DialogActions__WEBPACK_IMPORTED_MODULE_6___default","_material_ui_core_Button__WEBPACK_IMPORTED_MODULE_14___default","pouchdbAdapterHttp","createRxDb","erfassen","messageSchema","zeitSchema","ortSchema","ort","beobSchema","beob","abrupt","RxDbContainer","_Object$assign","newDbs","_Object$assign2","newSyncs","RxDbState","module","exports","toLowerCase"],"mappings":"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","file":"2-7b36cadfb66f9b630844.js","sourcesContent":["// @flow\r\nimport React, { Component } from 'react'\r\nimport styled from 'styled-components'\r\nimport Button from '@material-ui/core/Button'\r\n\r\nconst Container = styled.div`\r\n  margin: 10px;\r\n`\r\nconst ErrorTitle = styled.div`\r\n  margin-bottom: 10px;\r\n`\r\nconst ReloadButton = styled(Button)`\r\n  margin-top: 10px !important;\r\n`\r\n\r\ninterface Props {}\r\ninterface State {\r\n  error: Error\r\n  errorInfo: any\r\n}\r\n\r\nclass ErrorBoundary<Props, State> extends Component {\r\n  constructor(props: Props) {\r\n    super(props)\r\n    this.state = { error: null, errorInfo: null }\r\n  }\r\n\r\n  componentDidCatch(error: Error, errorInfo: any) {\r\n    // Catch errors in any components below and re-render with error message\r\n    this.setState({\r\n      error: error,\r\n      errorInfo: errorInfo,\r\n    })\r\n  }\r\n\r\n  render() {\r\n    const { errorInfo } = this.state\r\n    if (errorInfo) {\r\n      console.log('errorInfo:', errorInfo)\r\n      return (\r\n        <Container>\r\n          <ErrorTitle>\r\n            Oh je, es ist ein Fehler aufgetreten! Bericht:\r\n          </ErrorTitle>\r\n          <div>{errorInfo.componentStack}</div>\r\n          <ReloadButton\r\n            variant=\"outlined\"\r\n            onClick={() => {\r\n              typeof window !== 'undefined' && window.location.reload(false)\r\n            }}\r\n          >\r\n            Neu laden\r\n          </ReloadButton>\r\n        </Container>\r\n      )\r\n    }\r\n    const { children } = this.props\r\n    var childrenWithProps = React.Children.map(children, child =>\r\n      React.cloneElement(child, { ...this.props }),\r\n    )\r\n\r\n    // Normally, just render children\r\n    // and pass all props\r\n    return childrenWithProps\r\n  }\r\n}\r\n\r\nexport default ErrorBoundary\r\n","import rxdb from 'rxdb'\r\nimport pouchdbAdapterIdb from 'pouchdb-adapter-idb'\r\n\r\nrxdb.plugin(pouchdbAdapterIdb)\r\n\r\nimport { Props as rxDbStateProps } from '../state/RxDb'\r\nimport userDbNameFromUserName from './userDbNameFromUserName'\r\nimport userDocSchema from '../schemas/userDoc.json'\r\n\r\nexport default async ({\r\n  rxDbState,\r\n  email,\r\n}: {\r\n  rxDbState: rxDbStateProps\r\n  email: string\r\n}) => {\r\n  const { dbs, syncs } = rxDbState.state\r\n  // create userDoc Collection\r\n  // then sync it\r\n  const userDbName = userDbNameFromUserName(email)\r\n  console.log('createAndSyncUserCollections', { dbs, syncs, rxDbState })\r\n  let userDb\r\n  if (!rxdb.isRxDatabase(dbs[userDbName])) {\r\n    userDb = await rxdb.create({\r\n      name: userDbName,\r\n      adapter: 'idb',\r\n    })\r\n    await userDb.collection({\r\n      name: 'user',\r\n      schema: userDocSchema,\r\n    })\r\n  }\r\n  // TODO: enable next line again\r\n  rxDbState.addDb({ name: userDbName, db: userDb })\r\n  const isAlreadyBeingSynced: boolean = !!syncs && !!syncs[userDbName]\r\n  console.log('createAndSyncUserCollections', { dbs })\r\n  let sync\r\n  if (!isAlreadyBeingSynced) {\r\n    sync = userDb.user.sync({\r\n      remote: `http://localhost:5984/${userDbName}/`,\r\n      options: {\r\n        live: true,\r\n        retry: true,\r\n      },\r\n      query: userDb.user\r\n        .find()\r\n        .where('type')\r\n        .eq('user'),\r\n    })\r\n  }\r\n  rxDbState.addSync({ name: userDbName, sync })\r\n  console.log('Signup', { dbs, userDbName })\r\n}\r\n","// @flow\r\nimport React from 'react'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport DialogActions from '@material-ui/core/DialogActions'\r\nimport Input from '@material-ui/core/Input'\r\nimport InputLabel from '@material-ui/core/InputLabel'\r\nimport InputAdornment from '@material-ui/core/InputAdornment'\r\nimport FormControl from '@material-ui/core/FormControl'\r\nimport FormHelperText from '@material-ui/core/FormHelperText'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport { MdVisibility, MdVisibilityOff } from 'react-icons/md'\r\nimport Button from '@material-ui/core/Button'\r\nimport styled from 'styled-components'\r\nimport compose from 'recompose/compose'\r\nimport withHandlers from 'recompose/withHandlers'\r\nimport withState from 'recompose/withState'\r\n\r\nimport ErrorBoundary from '../ErrorBoundary'\r\nimport withAuthState from '../../state/withAuth'\r\nimport withRxDbState from '../../state/withRxDb'\r\nimport { Props as authStateProps } from '../../state/Auth'\r\nimport { Props as rxDbStateProps } from '../../state/RxDb'\r\nimport userDbNameFromUserName from '../../utils/userDbNameFromUserName'\r\nimport userDocSchema from '../../schemas/userDoc.json'\r\nimport createAndSyncUserCollection from '../../utils/createAndSyncUserCollection'\r\n\r\nconst StyledDialog = styled(Dialog)``\r\nconst StyledDiv = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 0 24px;\r\n`\r\nconst StyledInput = styled(Input)`\r\n  &:before {\r\n    border-bottom-color: rgba(0, 0, 0, 0.1) !important;\r\n  }\r\n`\r\n\r\nconst enhance = compose(\r\n  withAuthState,\r\n  withRxDbState,\r\n  withState('email', 'setEmail', ''),\r\n  withState('password', 'setPassword', ''),\r\n  withState('showPass', 'setShowPass', false),\r\n  withState('emailErrorText', 'setEmailErrorText', ''),\r\n  withState('passwordErrorText', 'setPasswordErrorText', ''),\r\n  withHandlers<any, any>({\r\n    close: ({ authState }: { authState: authStateProps }) => () =>\r\n      authState.setSignupOpen(false),\r\n    onClickSignup: ({\r\n      email,\r\n      password,\r\n      authState,\r\n      rxDbState,\r\n    }: {\r\n      email: string\r\n      password: string\r\n      authState: authStateProps\r\n      rxDbState: rxDbStateProps\r\n    }) => async () => {\r\n      try {\r\n        await authState.state.authDb.signUp(email, password)\r\n      } catch (error) {\r\n        console.log('Signup: error logging in:', error)\r\n      }\r\n      // log in\r\n      try {\r\n        await authState.logIn({ email, password })\r\n      } catch (error) {\r\n        throw error\r\n      }\r\n      createAndSyncUserCollection({ rxDbState, email })\r\n    },\r\n    onToggleShowPass: ({\r\n      showPass,\r\n      setShowPass,\r\n    }: {\r\n      showPass: boolean\r\n      setShowPass: (showPass: boolean) => void\r\n    }) => () => {\r\n      setShowPass(!showPass)\r\n    },\r\n  }),\r\n  withHandlers<any, any>({\r\n    onBlurEmail: ({ setEmail }: { setEmail: (email: string) => void }) => (\r\n      event: Event,\r\n    ) => setEmail(event.target.value),\r\n    onBlurPassword: ({\r\n      setPassword,\r\n    }: {\r\n      setPassword: (password: string) => void\r\n    }) => (event: Event) => setPassword(event.target.value),\r\n  }),\r\n)\r\n\r\nconst Signup = ({\r\n  email,\r\n  password,\r\n  showPass,\r\n  setShowPass,\r\n  emailErrorText,\r\n  passwordErrorText,\r\n  setEmailErrorText,\r\n  setPasswordErrorText,\r\n  onBlurEmail,\r\n  onBlurPassword,\r\n  onClickSignup,\r\n  user,\r\n  close,\r\n  onToggleShowPass,\r\n  db,\r\n  authState,\r\n}: {\r\n  email: string\r\n  showPass: boolean\r\n  setEmail: () => void\r\n  password: string\r\n  setShowPass: (showPass: boolean) => void\r\n  setPassword: () => void\r\n  emailErrorText: string\r\n  setEmailErrorText: () => void\r\n  passwordErrorText: string\r\n  setPasswordErrorText: () => void\r\n  onBlurEmail: () => void\r\n  onBlurPassword: () => void\r\n  onClickSignup: () => void\r\n  user: Object\r\n  close: () => void\r\n  onToggleShowPass: () => void\r\n  db: any\r\n  authState: authStateProps\r\n}) => (\r\n  <ErrorBoundary>\r\n    <StyledDialog\r\n      aria-labelledby=\"dialog-title\"\r\n      open={authState.state.signupOpen}\r\n    >\r\n      <DialogTitle id=\"dialog-title\">Neues Konto</DialogTitle>\r\n      <StyledDiv>\r\n        <FormControl\r\n          error={!!emailErrorText}\r\n          fullWidth\r\n          aria-describedby=\"emailHelper\"\r\n        >\r\n          <InputLabel htmlFor=\"email\">Email</InputLabel>\r\n          <StyledInput\r\n            id=\"email\"\r\n            defaultValue={email}\r\n            onBlur={onBlurEmail}\r\n            autoFocus\r\n            onKeyPress={e => {\r\n              if (e.key === 'Enter') {\r\n                onBlurEmail()\r\n              }\r\n            }}\r\n          />\r\n          <FormHelperText id=\"emailHelper\">{emailErrorText}</FormHelperText>\r\n        </FormControl>\r\n        <FormControl\r\n          error={!!passwordErrorText}\r\n          fullWidth\r\n          aria-describedby=\"passwortHelper\"\r\n        >\r\n          <InputLabel htmlFor=\"passwort\">Passwort</InputLabel>\r\n          <StyledInput\r\n            id=\"passwort\"\r\n            type={showPass ? 'text' : 'password'}\r\n            defaultValue={password}\r\n            onBlur={onBlurPassword}\r\n            onKeyPress={e => {\r\n              if (e.key === 'Enter') {\r\n                onBlurPassword()\r\n              }\r\n            }}\r\n            autoComplete=\"current-password\"\r\n            autoCorrect=\"off\"\r\n            spellCheck=\"false\"\r\n            endAdornment={\r\n              <InputAdornment position=\"end\">\r\n                <IconButton\r\n                  onClick={onToggleShowPass}\r\n                  onMouseDown={e => e.preventDefault()}\r\n                  title={showPass ? 'verstecken' : 'anzeigen'}\r\n                >\r\n                  {showPass ? <MdVisibilityOff /> : <MdVisibility />}\r\n                </IconButton>\r\n              </InputAdornment>\r\n            }\r\n          />\r\n          <FormHelperText id=\"passwortHelper\">\r\n            {passwordErrorText}\r\n          </FormHelperText>\r\n        </FormControl>\r\n      </StyledDiv>\r\n      <DialogActions>\r\n        <Button onClick={close}>abbrechen</Button>\r\n        <Button color=\"primary\" onClick={onClickSignup}>\r\n          Konto erstellen\r\n        </Button>\r\n      </DialogActions>\r\n    </StyledDialog>\r\n  </ErrorBoundary>\r\n)\r\n\r\nexport default enhance(Signup)\r\n","import React from 'react'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport MenuItem from '@material-ui/core/MenuItem'\r\nimport Menu from '@material-ui/core/Menu'\r\nimport { FaUserCircle as UserIcon } from 'react-icons/fa'\r\nimport compose from 'recompose/compose'\r\nimport withHandlers from 'recompose/withHandlers'\r\nimport withState from 'recompose/withState'\r\nimport styled from 'styled-components'\r\n\r\nimport Signup from './Signup'\r\nimport Login from './Login'\r\nimport ErrorBoundary from '../ErrorBoundary'\r\nimport withAuthState from '../../state/withAuth'\r\nimport { Props as authStateProps } from '../../state/Auth'\r\n\r\nconst IconContainer = styled.div`\r\n  position: relative;\r\n  padding-left: 10px;\r\n`\r\nconst UserNameDiv = styled.div`\r\n  position: absolute;\r\n  bottom: 0;\r\n  font-size: 10px;\r\n  width: 60px;\r\n  left: 5px;\r\n  text-align: center;\r\n  text-overflow: ellipsis;\r\n  overflow: hidden;\r\n  white-space: nowrap;\r\n  /* ensure cursor is not changed */\r\n  z-index: -1;\r\n`\r\n\r\ninterface Props {\r\n  anchorEl: EventTarget | null\r\n  setAnchorEl: (anchorEl: EventTarget | null) => void\r\n  onClickMenu: (event: Event) => void\r\n  onCloseMenu: (event: Event) => void\r\n  onClickSignup: (signupOpen: boolean) => void\r\n  onClickLognin: (signupOpen: boolean) => void\r\n  authState: authStateProps\r\n}\r\n\r\nconst enhance = compose(\r\n  withAuthState,\r\n  withState('anchorEl', 'setAnchorEl', null),\r\n  withHandlers<any, any>({\r\n    onClickMenu: ({\r\n      setAnchorEl,\r\n    }: {\r\n      setAnchorEl: (anchorEl: EventTarget | null) => void\r\n    }) => (event: Event) => setAnchorEl(event.currentTarget),\r\n    onCloseMenu: ({\r\n      setAnchorEl,\r\n    }: {\r\n      setAnchorEl: (anchorEl: EventTarget | null) => void\r\n    }) => () => setAnchorEl(null),\r\n    onClickSignup: ({\r\n      setAnchorEl,\r\n      authState,\r\n    }: {\r\n      setAnchorEl: (anchorEl: EventTarget | null) => void\r\n      authState: authStateProps\r\n    }) => () => {\r\n      setAnchorEl(null)\r\n      authState.setSignupOpen(!authState.state.signupOpen)\r\n    },\r\n    onClickLogin: ({\r\n      setAnchorEl,\r\n      authState,\r\n    }: {\r\n      setAnchorEl: (anchorEl: EventTarget | null) => void\r\n      authState: authStateProps\r\n    }) => () => {\r\n      setAnchorEl(null)\r\n      authState.setLoginOpen(!authState.state.loginOpen)\r\n    },\r\n    onClickLogout: ({\r\n      setAnchorEl,\r\n      authState,\r\n    }: {\r\n      setAnchorEl: (anchorEl: EventTarget | null) => void\r\n      authState: authStateProps\r\n    }) => () => {\r\n      setAnchorEl(null)\r\n      authState.logOut()\r\n    },\r\n  }),\r\n)\r\n\r\nconst Account: React.SFC<Props> = ({\r\n  anchorEl,\r\n  onCloseMenu,\r\n  onClickMenu,\r\n  onClickSignup,\r\n  onClickLogout,\r\n  onClickLogin,\r\n  authState,\r\n}) => {\r\n  const { name, signupOpen, loginOpen } = authState.state\r\n\r\n  return (\r\n    <ErrorBoundary>\r\n      <>\r\n        <IconContainer>\r\n          <IconButton\r\n            aria-haspopup=\"true\"\r\n            aria-label=\"Konto\"\r\n            onClick={onClickMenu}\r\n            color=\"inherit\"\r\n            title=\"Konto\"\r\n          >\r\n            <UserIcon />\r\n          </IconButton>\r\n          <UserNameDiv>{name || ''}</UserNameDiv>\r\n        </IconContainer>\r\n        <Menu\r\n          id=\"menu-appbar\"\r\n          anchorEl={anchorEl}\r\n          anchorOrigin={{\r\n            vertical: 'top',\r\n            horizontal: 'right',\r\n          }}\r\n          transformOrigin={{\r\n            vertical: 'top',\r\n            horizontal: 'right',\r\n          }}\r\n          open={!!anchorEl}\r\n          onClose={onCloseMenu}\r\n        >\r\n          {!name && <MenuItem onClick={onClickLogin}>Anmelden</MenuItem>}\r\n          {name && <MenuItem onClick={onClickLogout}>Abmelden</MenuItem>}\r\n          <MenuItem onClick={onClickSignup}>Konto erstellen</MenuItem>\r\n        </Menu>\r\n        {signupOpen && <Signup />}\r\n        {loginOpen && <Login />}\r\n      </>\r\n    </ErrorBoundary>\r\n  )\r\n}\r\n\r\nexport default enhance(Account)\r\n","import React from 'react'\r\nimport AppBar from '@material-ui/core/AppBar'\r\nimport Toolbar from '@material-ui/core/Toolbar'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport Button from '@material-ui/core/Button'\r\nimport styled from 'styled-components'\r\nimport { Link, navigate } from 'gatsby'\r\nimport { Location } from '@reach/router'\r\nimport compose from 'recompose/compose'\r\nimport withHandlers from 'recompose/withHandlers'\r\n\r\nimport Account from './Account'\r\nimport ErrorBoundary from '../ErrorBoundary'\r\n\r\nconst SiteTitle = styled(Typography)`\r\n  display: none;\r\n  cursor: pointer;\r\n  @media (min-width: 700px) {\r\n    display: block;\r\n  }\r\n`\r\nconst Spacer = styled.div`\r\n  flex-grow: 1;\r\n`\r\ninterface NavButtonProps {\r\n  active: boolean\r\n}\r\nconst NavButton = styled<NavButtonProps, any>(Button)`\r\n  color: white !important;\r\n  border: ${props => (props.active ? '1px white' : 'unset')};\r\n  border-color: rgba(255, 255, 255, 0.5) !important;\r\n  font-weight: ${props => (props.active ? '700' : '600')};\r\n`\r\n\r\nconst enhance = compose(\r\n  withHandlers({ onClickSiteTitle: () => () => navigate('/') }),\r\n)\r\n\r\ninterface Props {\r\n  onClickSiteTitle: () => void\r\n}\r\n\r\nconst Header: React.SFC<Props> = ({ onClickSiteTitle }) => (\r\n  <Location>\r\n    {({ location }) => {\r\n      const { pathname } = location\r\n\r\n      return (\r\n        <ErrorBoundary>\r\n          <AppBar position=\"fixed\">\r\n            <Toolbar>\r\n              <SiteTitle\r\n                variant=\"h6\"\r\n                color=\"inherit\"\r\n                noWrap\r\n                title=\"Home\"\r\n                onClick={onClickSiteTitle}\r\n              >\r\n                erfassen.ch\r\n              </SiteTitle>\r\n              <Spacer />\r\n              <NavButton\r\n                variant={pathname === '/' ? 'outlined' : 'text'}\r\n                component={Link}\r\n                to=\"/\"\r\n                active={(pathname === '/').toString()}\r\n              >\r\n                Home\r\n              </NavButton>\r\n              <NavButton\r\n                variant={pathname === '/Projekte/' ? 'outlined' : 'text'}\r\n                component={Link}\r\n                to=\"/Projekte/\"\r\n                active={(pathname === '/Projekte/').toString()}\r\n              >\r\n                Projekte\r\n              </NavButton>\r\n              <Account />\r\n            </Toolbar>\r\n          </AppBar>\r\n        </ErrorBoundary>\r\n      )\r\n    }}\r\n  </Location>\r\n)\r\n\r\nexport default enhance(Header)\r\n","/**\r\n * Cant move Helmet to App\r\n * because neither StaticQuery nor AppQuery\r\n * work there :-(\r\n */\r\nimport React from 'react'\r\nimport Helmet from 'react-helmet'\r\nimport { StaticQuery, graphql } from 'gatsby'\r\n\r\nimport Header from './Header'\r\n\r\nconst query = graphql`\r\n  query SiteTitleQuery {\r\n    site {\r\n      siteMetadata {\r\n        title\r\n      }\r\n    }\r\n  }\r\n`\r\n\r\nconst Layout: React.SFC<{}> = ({ children }) => (\r\n  <StaticQuery\r\n    query={query}\r\n    render={data => (\r\n      <>\r\n        <Helmet\r\n          title={data.site.siteMetadata.title}\r\n          meta={[\r\n            { name: 'description', content: 'Sample' },\r\n            { name: 'keywords', content: 'sample, something' },\r\n          ]}\r\n        >\r\n          <html lang=\"en\" />\r\n        </Helmet>\r\n        <Header />\r\n        {children}\r\n      </>\r\n    )}\r\n  />\r\n)\r\n\r\nexport default Layout\r\n","// in development should return local path\r\nexport default () => {\r\n  if (typeof window === 'undefined') {\r\n    return 'https://erfassen.ch:5984/erfassen'\r\n  }\r\n  const hostnameWithoutWww: string = window.location.hostname.replace(\r\n    'www.',\r\n    '',\r\n  )\r\n  const isLocalhost: boolean = hostnameWithoutWww === 'localhost'\r\n  const hostname = isLocalhost ? 'localhost' : window.location.hostname\r\n  const couchUrl: string = isLocalhost\r\n    ? `http://${hostname}:5984/erfassen`\r\n    : `https://erfassen.ch:5984/erfassen`\r\n\r\n  return couchUrl\r\n}\r\n","import { Container } from 'unstated'\r\n/**\r\n * somehow gatsby manages to sometimes (not always)\r\n * drag this file through node which makes\r\n * pouchdb-browser complain fetch is missing\r\n * using pouchdb is no solution because that complains\r\n * to miss many bindings\r\n */\r\nimport 'isomorphic-fetch'\r\nimport PouchDB from 'pouchdb-browser'\r\nimport pouchdbAuthentication from 'pouchdb-authentication'\r\nimport get from 'lodash/get'\r\n\r\nimport couchUrl from '../utils/couchUrl'\r\n\r\nPouchDB.plugin(pouchdbAuthentication)\r\n\r\ninterface LogInProps {\r\n  email: string\r\n  password: string\r\n}\r\n\r\ninterface StateProps {\r\n  authDb: any\r\n  name: string | null\r\n  signupOpen: boolean\r\n  loginOpen: boolean\r\n}\r\nexport interface Props {\r\n  state: StateProps\r\n  setAuthDb: (authDb: any) => void\r\n  setName: (name: string | null) => void\r\n  setSignupOpen: (signupOpen: boolean) => void\r\n  setLoginOpen: (loginOpen: boolean) => void\r\n  logIn: () => void\r\n  logOut: () => void\r\n}\r\n\r\nexport default class AuthContainer extends Container<StateProps> {\r\n  constructor(props: StateProps) {\r\n    super()\r\n    const authDb = new PouchDB(couchUrl())\r\n    this.state = {\r\n      authDb,\r\n      name: null,\r\n      signupOpen: false,\r\n      loginOpen: false,\r\n    }\r\n\r\n    authDb\r\n      .getSession()\r\n      .then((resp: any) => {\r\n        const name = get(resp, 'userCtx.name', null)\r\n        if (name) {\r\n          this.setState(state => ({ name }))\r\n        }\r\n      })\r\n      .catch((error: Error) => {\r\n        throw error\r\n      })\r\n  }\r\n\r\n  setAuthDb = (authDb: any) => {\r\n    this.setState(state => ({ authDb }))\r\n  }\r\n\r\n  setName = (name: string | null) => {\r\n    this.setState(state => ({ name }))\r\n  }\r\n\r\n  setSignupOpen = (signupOpen: boolean) => {\r\n    this.setState(state => ({ signupOpen }))\r\n  }\r\n\r\n  setLoginOpen = (loginOpen: boolean) => {\r\n    this.setState(state => ({ loginOpen }))\r\n  }\r\n\r\n  logIn = async ({ email, password }: LogInProps) => {\r\n    let logInResponce: any\r\n    try {\r\n      logInResponce = await this.state.authDb.logIn(email, password)\r\n    } catch (error) {\r\n      if (error.name === 'unauthorized' || error.name === 'forbidden') {\r\n        // name or password incorrect\r\n        throw new Error('Name oder Passwort stimmt nicht')\r\n      } else {\r\n        // cosmic rays, a meteor, etc.\r\n        throw error\r\n      }\r\n    }\r\n    console.log('Login: logInResponce logging in:', logInResponce)\r\n    this.setState(state => ({ name: logInResponce.name, loginOpen: false }))\r\n  }\r\n\r\n  logOut = async () => {\r\n    try {\r\n      await this.state.authDb.logOut()\r\n    } catch (error) {\r\n      throw error\r\n    }\r\n    this.setState(state => ({ name: null, loginOpen: false }))\r\n  }\r\n}\r\n","/**\r\n * inspired from:\r\n * https://www.reddit.com/r/reactjs/comments/8t3di7/how_do_you_access_your_store_in_lifecycle/\r\n * example: https://github.com/jaredpalmer/react-fns/blob/052ea56092c53946c7937e1d32adf78a7d37d6f3/src/GeoPosition/withGeoPosition.tsx\r\n */\r\nimport React from 'react'\r\nimport { Subscribe } from 'unstated'\r\n\r\nimport AuthState from './Auth'\r\n\r\nexport default WrappedComponent => props => (\r\n  <Subscribe to={[AuthState]}>\r\n    {value => <WrappedComponent authState={value} {...props} />}\r\n  </Subscribe>\r\n)\r\n","// @flow\r\nimport React from 'react'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport DialogActions from '@material-ui/core/DialogActions'\r\nimport Input from '@material-ui/core/Input'\r\nimport InputLabel from '@material-ui/core/InputLabel'\r\nimport InputAdornment from '@material-ui/core/InputAdornment'\r\nimport FormControl from '@material-ui/core/FormControl'\r\nimport FormHelperText from '@material-ui/core/FormHelperText'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport { MdVisibility, MdVisibilityOff } from 'react-icons/md'\r\nimport Button from '@material-ui/core/Button'\r\nimport styled from 'styled-components'\r\nimport compose from 'recompose/compose'\r\nimport withHandlers from 'recompose/withHandlers'\r\nimport withState from 'recompose/withState'\r\n\r\nimport ErrorBoundary from '../ErrorBoundary'\r\nimport withAuthState from '../../state/withAuth'\r\nimport { Props as authStateProps } from '../../state/Auth'\r\n\r\nconst StyledDialog = styled(Dialog)``\r\nconst StyledDiv = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 0 24px;\r\n`\r\nconst StyledInput = styled(Input)`\r\n  &:before {\r\n    border-bottom-color: rgba(0, 0, 0, 0.1) !important;\r\n  }\r\n`\r\n\r\nconst enhance = compose(\r\n  withAuthState,\r\n  withState('email', 'setEmail', ''),\r\n  withState('password', 'setPassword', ''),\r\n  withState('showPass', 'setShowPass', false),\r\n  withState('emailErrorText', 'setEmailErrorText', ''),\r\n  withState('passwordErrorText', 'setPasswordErrorText', ''),\r\n  withHandlers<any, any>({\r\n    close: ({ authState }: { authState: authStateProps }) => () =>\r\n      authState.setLoginOpen(false),\r\n    onClickLogin: ({\r\n      email,\r\n      password,\r\n      authState,\r\n    }: {\r\n      email: string\r\n      password: string\r\n      authState: authStateProps\r\n    }) => async () => {\r\n      try {\r\n        await authState.logIn({ email, password })\r\n      } catch (error) {\r\n        throw error\r\n      }\r\n    },\r\n    onToggleShowPass: ({\r\n      showPass,\r\n      setShowPass,\r\n    }: {\r\n      showPass: boolean\r\n      setShowPass: (showPass: boolean) => void\r\n    }) => () => {\r\n      setShowPass(!showPass)\r\n    },\r\n  }),\r\n  withHandlers<any, any>({\r\n    onBlurEmail: ({ setEmail }: { setEmail: (email: string) => void }) => (\r\n      event: Event,\r\n    ) => setEmail(event.target.value),\r\n    onBlurPassword: ({\r\n      setPassword,\r\n    }: {\r\n      setPassword: (password: string) => void\r\n    }) => (event: Event) => setPassword(event.target.value),\r\n  }),\r\n)\r\n\r\nconst Login = ({\r\n  email,\r\n  password,\r\n  showPass,\r\n  setShowPass,\r\n  emailErrorText,\r\n  passwordErrorText,\r\n  setEmailErrorText,\r\n  setPasswordErrorText,\r\n  onBlurEmail,\r\n  onBlurPassword,\r\n  onClickLogin,\r\n  close,\r\n  onToggleShowPass,\r\n  authState,\r\n}: {\r\n  email: string\r\n  showPass: boolean\r\n  setEmail: () => void\r\n  password: string\r\n  setShowPass: (showPass: boolean) => void\r\n  setPassword: () => void\r\n  emailErrorText: string\r\n  setEmailErrorText: () => void\r\n  passwordErrorText: string\r\n  setPasswordErrorText: () => void\r\n  onBlurEmail: () => void\r\n  onBlurPassword: () => void\r\n  onClickLogin: () => void\r\n  close: () => void\r\n  onToggleShowPass: () => void\r\n  authState: authStateProps\r\n}) => (\r\n  <ErrorBoundary>\r\n    <StyledDialog\r\n      aria-labelledby=\"login-dialog-title\"\r\n      open={authState.state.loginOpen}\r\n    >\r\n      <DialogTitle id=\"login-dialog-title\">Anmeldung</DialogTitle>\r\n      <StyledDiv>\r\n        <FormControl\r\n          error={!!emailErrorText}\r\n          fullWidth\r\n          aria-describedby=\"loginEmailHelper\"\r\n        >\r\n          <InputLabel htmlFor=\"loginEmail\">Email</InputLabel>\r\n          <StyledInput\r\n            id=\"loginEmail\"\r\n            defaultValue={email}\r\n            onBlur={onBlurEmail}\r\n            autoFocus\r\n            onKeyPress={e => {\r\n              if (e.key === 'Enter') {\r\n                onBlurEmail(e)\r\n              }\r\n            }}\r\n          />\r\n          <FormHelperText id=\"loginEmailHelper\">\r\n            {emailErrorText}\r\n          </FormHelperText>\r\n        </FormControl>\r\n        <FormControl\r\n          error={!!passwordErrorText}\r\n          fullWidth\r\n          aria-describedby=\"loginPasswortHelper\"\r\n        >\r\n          <InputLabel htmlFor=\"loginPasswort\">Passwort</InputLabel>\r\n          <StyledInput\r\n            id=\"loginPasswort\"\r\n            type={showPass ? 'text' : 'password'}\r\n            defaultValue={password}\r\n            onBlur={onBlurPassword}\r\n            onKeyPress={e => {\r\n              if (e.key === 'Enter') {\r\n                onBlurPassword(e)\r\n              }\r\n            }}\r\n            autoComplete=\"current-password\"\r\n            autoCorrect=\"off\"\r\n            spellCheck=\"false\"\r\n            endAdornment={\r\n              <InputAdornment position=\"end\">\r\n                <IconButton\r\n                  onClick={onToggleShowPass}\r\n                  onMouseDown={e => e.preventDefault()}\r\n                  title={showPass ? 'verstecken' : 'anzeigen'}\r\n                >\r\n                  {showPass ? <MdVisibilityOff /> : <MdVisibility />}\r\n                </IconButton>\r\n              </InputAdornment>\r\n            }\r\n          />\r\n          <FormHelperText id=\"loginPasswortHelper\">\r\n            {passwordErrorText}\r\n          </FormHelperText>\r\n        </FormControl>\r\n      </StyledDiv>\r\n      <DialogActions>\r\n        <Button onClick={close}>abbrechen</Button>\r\n        <Button color=\"primary\" onClick={onClickLogin}>\r\n          Anmelden\r\n        </Button>\r\n      </DialogActions>\r\n    </StyledDialog>\r\n  </ErrorBoundary>\r\n)\r\n\r\nexport default enhance(Login)\r\n","import rxdb from 'rxdb'\r\n\r\nimport pouchdbAdapterHttp from 'pouchdb-adapter-http'\r\nimport pouchdbAdapterIdb from 'pouchdb-adapter-idb'\r\n\r\nimport zeitSchema from '../schemas/zeit.json'\r\nimport ortSchema from '../schemas/ort.json'\r\nimport beobSchema from '../schemas/beob.json'\r\nimport messageSchema from '../schemas/message.json'\r\n\r\nrxdb.plugin(pouchdbAdapterHttp)\r\nrxdb.plugin(pouchdbAdapterIdb)\r\n\r\nexport default async () => {\r\n  // TODO:\r\n  // 1. fetch userDoc and it's project list\r\n  // 2. for every project create an rxdb\r\n  // 3. for every project fetch typeDefs doc and extract table list\r\n  // 4. for every table create collection and sync it\r\n  let syncs: any = {}\r\n  let dbs = {}\r\n  try {\r\n    dbs.erfassen = await rxdb.create({\r\n      name: 'erfassen',\r\n      adapter: 'idb',\r\n    })\r\n  } catch (error) {\r\n    throw error\r\n  }\r\n  // maybe use\r\n  // https://github.com/rafamel/rxdb-utils#models\r\n  // to make this easier\r\n  await dbs.erfassen.collection({\r\n    name: 'message',\r\n    schema: messageSchema,\r\n  })\r\n  await dbs.erfassen.collection({\r\n    name: 'zeit',\r\n    schema: zeitSchema,\r\n  })\r\n  await dbs.erfassen.collection({\r\n    name: 'ort',\r\n    schema: ortSchema,\r\n  })\r\n  /**\r\n   * create global sync object\r\n   * and pass it sync responces\r\n   * reason: be able to check if replication exists already\r\n   * before starting new one\r\n   */\r\n  syncs.ort = await dbs.erfassen.ort.sync({\r\n    remote: 'http://localhost:5984/erfassen/',\r\n    options: {\r\n      live: true,\r\n      retry: true,\r\n    },\r\n    query: dbs.erfassen.ort\r\n      .find()\r\n      .where('type')\r\n      .eq('ort'),\r\n  })\r\n  await dbs.erfassen.collection({\r\n    name: 'beob',\r\n    schema: beobSchema,\r\n  })\r\n  syncs.beob = dbs.erfassen.beob.sync({\r\n    remote: 'http://localhost:5984/erfassen/',\r\n    options: {\r\n      live: true,\r\n      retry: true,\r\n    },\r\n    query: dbs.erfassen.beob\r\n      .find()\r\n      .where('type')\r\n      .eq('beob'),\r\n  })\r\n\r\n  return { dbs, syncs }\r\n}\r\n","import { Container } from 'unstated'\r\n\r\nimport createRxDb from '../utils/createRxDb'\r\n\r\ninterface StateProps {\r\n  dbs: any\r\n  syncs: Object\r\n}\r\nexport interface Props {\r\n  state: StateProps\r\n  addDb: () => void\r\n  addSync: () => void\r\n}\r\ndeclare global {\r\n  interface Window {\r\n    dbs: any\r\n  }\r\n}\r\n\r\n/**\r\n * window.dbs is a hack\r\n * state gets lost in live update in gatsby\r\n * so need to set it on window and fetch it from there\r\n * to enable nice dev experience\r\n */\r\nexport default class RxDbContainer extends Container<StateProps> {\r\n  constructor(props: StateProps) {\r\n    super()\r\n    const dbs = typeof window === 'undefined' ? null : window.dbs || null\r\n    this.state = {\r\n      dbs,\r\n      syncs: {},\r\n    }\r\n    // create initial state\r\n    if (\r\n      (typeof window !== 'undefined' && !window.dbs) ||\r\n      typeof window === 'undefined'\r\n    ) {\r\n      // as hard as I tried, could not get typescript to type .then correctly\r\n      createRxDb()\r\n        .then(({ dbs, syncs }) => {\r\n          this.setState(state => ({ dbs, syncs }))\r\n          console.log({ syncs })\r\n          if (typeof window !== 'undefined') window.dbs = dbs\r\n        })\r\n        .catch(error => {\r\n          throw error\r\n        })\r\n    }\r\n  }\r\n\r\n  addDb = ({ name, db }: { name: string; db: any }) => {\r\n    console.log('RxDb, addDb', { name, db, dbs: this.state.dbs })\r\n    this.setState(state => {\r\n      const newDbs = {\r\n        ...state.dbs,\r\n        [name]: db,\r\n      }\r\n      console.log('RxDb, addDb', { newDbs })\r\n      return {\r\n        dbs: newDbs,\r\n        //syncs: state.syncs,\r\n      }\r\n    })\r\n  }\r\n\r\n  addSync = ({ name, sync }: { name: string; sync: any }) => {\r\n    this.setState(state => {\r\n      const newSyncs = {\r\n        ...state.syncs,\r\n        [name]: sync,\r\n      }\r\n      return {\r\n        dbs: state.dbs,\r\n        syncs: newSyncs,\r\n      }\r\n    })\r\n  }\r\n}\r\n","/**\r\n * inspired from:\r\n * https://www.reddit.com/r/reactjs/comments/8t3di7/how_do_you_access_your_store_in_lifecycle/\r\n * example: https://github.com/jaredpalmer/react-fns/blob/052ea56092c53946c7937e1d32adf78a7d37d6f3/src/GeoPosition/withGeoPosition.tsx\r\n */\r\nimport React from 'react'\r\nimport { Subscribe } from 'unstated'\r\n\r\nimport RxDbState from './RxDb'\r\n\r\nexport default function withRxDbState(WrappedComponent) {\r\n  return props => (\r\n    <Subscribe to={[RxDbState]}>\r\n      {value => <WrappedComponent rxDbState={value} {...props} />}\r\n    </Subscribe>\r\n  )\r\n}\r\n","module.exports = (name: string): string =>\r\n  'user_' +\r\n  name\r\n    .toLowerCase()\r\n    .replace('@', '_at_')\r\n    .replace('.', '_p_')\r\n"],"sourceRoot":""}